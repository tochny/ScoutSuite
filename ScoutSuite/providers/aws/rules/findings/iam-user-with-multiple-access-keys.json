{
    "description": "User with Multiple API Keys",
    "rationale": "The user was configured to have more than one active API keys associated with the account. Redundant or unused API keys should be removed.",
    "remediation": "Access keys enable an IAM user to sign requests to the AWS CLI or API, and are long-term credentials that enable programmatic actions. To safeguard access, only one access key should ever be available to a given IAM user",
    "compliance": [
        {
            "name": "CIS Amazon Web Services Foundations",
            "version": "1.4.0",
            "reference": "1.13"
        }
    ],
    "references": [
        "https://docs.aws.amazon.com/general/latest/gr/aws-access-keys-best-practices.html"
    ],
    "dashboard_name": "Users",
    "path": "iam.users.id",
    "conditions": [
        "and",
        [
            "iam.users.id.AccessKeys",
            "lengthMoreThan",
            "1"
        ],
        [
            "iam.users.id.AccessKeys.0.Status",
            "equal",
            "Active"
        ],
        [
            "iam.users.id.AccessKeys.1.Status",
            "equal",
            "Active"
        ]
    ],
    "keys": [
        "iam.users.id.name",
        "iam.users.id.AccessKeys"
    ],
    "id_suffix": "multiple_api_keys"
}
